[supervisord]
nodaemon=true
user=root

[program:xvfb]
command=Xvfb :1 -screen 0 %(ENV_SCREEN_RESOLUTION)sx24
autorestart=true
priority=1

[program:fluxbox]
command=fluxbox -display :1
environment=DISPLAY=":1"
autorestart=true
priority=2

[program:vnc]
command=bash /usr/local/bin/start-vnc.sh
environment=DISPLAY=":1",VNC_PASSWORD="%(ENV_VNC_PASSWORD)s"
autorestart=true
priority=3

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
autorestart=true
priority=10

[program:stream]
command=bash /usr/local/bin/stream.sh
environment=DISPLAY=":1"
autorestart=true
priority=10

[program:chrome]
# This is the updated command with flags for stability inside Docker.
# --disable-dev-shm-usage is a key flag to prevent crashes in limited memory environments.
command=google-chrome-stable --no-sandbox --start-maximized --user-data-dir=/root/chrome-data --no-first-run --disable-dev-shm-usage
environment=DISPLAY=":1"
autorestart=true
priority=5
